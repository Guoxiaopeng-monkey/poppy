!function(t){"use strict";const e="IntersectionObserver"in window,r="loading"in HTMLImageElement.prototype,i={_opts:{root:null,rootMargin:"200px 0px",threshold:.01,iframeThreshold:"300px 0px",observeMutations:!1,mutationDebounce:200,mutationWhitelist:["IMG","IFRAME","SCRIPT","LINK","PICTURE"],autoLoadScriptsAfter:0},_io:null,_iframeIo:null,_mutationObserver:null,init(t={}){this._opts={...this._opts,...t},this._initImageHandling(),this._initIframeHandling(),this._initScriptHandling(),this._initCssHandling(),this._opts.observeMutations&&this._initMutationObserver(),this._opts.autoLoadScriptsAfter>0&&window.addEventListener("load",()=>{setTimeout(()=>this.loadDeferredScripts(),this._opts.autoLoadScriptsAfter)})},_initImageHandling(){if(r&&document.querySelectorAll("img[data-src], img[data-srcset]").forEach(t=>{!t.getAttribute("src")&&t.dataset.src,t.setAttribute("loading","lazy")}),e){this._io||(this._io=new IntersectionObserver(this._onImageIntersect.bind(this),{root:this._opts.root,rootMargin:this._opts.rootMargin,threshold:this._opts.threshold}));document.querySelectorAll("img[data-src], img[data-srcset], picture[data-src]").forEach(t=>this._io.observe(t))}else setTimeout(()=>{document.querySelectorAll("img[data-src], img[data-srcset], picture[data-src]").forEach(t=>{this._applyImageSrc(t)})},300)},_onImageIntersect(t){t.forEach(t=>{(t.isIntersecting||t.intersectionRatio>0)&&(this._applyImageSrc(t.target),this._io.unobserve(t.target))})},_applyImageSrc(t){try{if("PICTURE"===t.tagName){const e=t.querySelector("img");return void(e&&this._applyImageSrc(e))}const e=t.dataset.src,r=t.dataset.srcset;e&&(t.setAttribute("src",e),t.removeAttribute("data-src")),r&&(t.setAttribute("srcset",r),t.removeAttribute("data-srcset")),t.classList.add("async-lazy--loaded")}catch(t){console.warn("AsyncLazyLoader image apply error",t)}},loadImage(t){if(t){if(this._io)try{this._io.unobserve(t)}catch(t){}this._applyImageSrc(t)}},_initIframeHandling(){e?(this._iframeIo||(this._iframeIo=new IntersectionObserver(this._onIframeIntersect.bind(this),{root:this._opts.root,rootMargin:this._opts.iframeThreshold||this._opts.rootMargin,threshold:this._opts.threshold})),document.querySelectorAll("iframe[data-src]").forEach(t=>this._iframeIo.observe(t))):window.addEventListener("load",()=>{document.querySelectorAll("iframe[data-src]").forEach(t=>this._applyIframeSrc(t))})},_onIframeIntersect(t){t.forEach(t=>{(t.isIntersecting||t.intersectionRatio>0)&&(this._applyIframeSrc(t.target),this._iframeIo.unobserve(t.target))})},_applyIframeSrc(t){try{const e=t.dataset.src;e&&(t.setAttribute("src",e),t.removeAttribute("data-src"),t.classList.add("async-lazy--loaded"))}catch(t){console.warn("AsyncLazyLoader iframe apply error",t)}},loadIframe(t){if(t){if(this._iframeIo)try{this._iframeIo.unobserve(t)}catch(t){}this._applyIframeSrc(t)}},_initScriptHandling(){this._deferredScripts=Array.from(document.querySelectorAll("script[data-src]"))},loadDeferredScripts({preserveOrder:t=!0}={}){if(!this._deferredScripts||0===this._deferredScripts.length)return;const e=Array.from(this._deferredScripts);if(this._deferredScripts=[],!t)return void e.forEach(t=>this._insertScript(t.dataset.src,t));const r=t=>{if(t>=e.length)return;const i=e[t];this._insertScript(i.dataset.src,i).then(()=>r(t+1)).catch(()=>r(t+1))};r(0)},_insertScript:(t,e)=>new Promise((r,i)=>{const s=document.createElement("script");s.src=t,e&&(e.type&&(s.type=e.type),e.async&&(s.async=!0),e.defer&&(s.defer=!0)),s.onload=()=>{s.classList.add("async-lazy--loaded"),r()},s.onerror=e=>{console.warn("AsyncLazyLoader script failed to load",t,e),i(e)},document.head.appendChild(s)}),loadScriptElement(t){if(t&&t.dataset&&t.dataset.src)return this._deferredScripts=(this._deferredScripts||[]).filter(e=>e!==t),this._insertScript(t.dataset.src,t)},_initCssHandling(){Array.from(document.querySelectorAll('link[rel="stylesheet"][data-href]')).forEach(t=>{const e=t.dataset.href;if(!e)return;const r=document.createElement("link");r.rel="preload",r.as="style",r.href=e,r.onload=function(){this.rel="stylesheet",t.id&&(this.id=t.id)},r.onerror=function(){const t=document.createElement("link");t.rel="stylesheet",t.href=e,document.head.appendChild(t)},document.head.appendChild(r),t.removeAttribute("data-href")})},_initMutationObserver(){if(!("MutationObserver"in window))return;this._mutationObserver=new MutationObserver(t=>{const e=[];t.forEach(t=>{t.addedNodes.forEach(t=>{t.tagName&&-1!==this._opts.mutationWhitelist.indexOf(t.tagName)&&e.push(t)})}),0!==e.length&&(this._mutationTimer&&clearTimeout(this._mutationTimer),this._mutationTimer=setTimeout(()=>{e.forEach(t=>this._processNodeForLazy(t))},this._opts.mutationDebounce))}),this._mutationObserver.observe(document.documentElement,{childList:!0,subtree:!0})},_processNodeForLazy(t){try{const e=t.tagName;if("IMG"===e||"PICTURE"===e)this._io?this._io.observe(t):this._applyImageSrc(t);else if("IFRAME"===e)this._iframeIo?this._iframeIo.observe(t):this._applyIframeSrc(t);else if("SCRIPT"===e)t.dataset&&t.dataset.src&&(this._deferredScripts=this._deferredScripts||[],this._deferredScripts.push(t));else if("LINK"===e&&"stylesheet"===t.rel&&t.dataset&&t.dataset.href){const e=t.dataset.href,r=document.createElement("link");r.rel="preload",r.as="style",r.href=e,r.onload=function(){this.rel="stylesheet"},document.head.appendChild(r),t.removeAttribute("data-href")}}catch(t){}},config(){return{...this._opts}},destroy(){try{this._io&&(this._io.disconnect(),this._io=null),this._iframeIo&&(this._iframeIo.disconnect(),this._iframeIo=null),this._mutationObserver&&(this._mutationObserver.disconnect(),this._mutationObserver=null)}catch(t){}}};var s;t.AsyncLazyLoader=i,s=()=>{"complete"===document.readyState||"interactive"===document.readyState?i.init():window.addEventListener("DOMContentLoaded",()=>i.init())},window.requestAnimationFrame?requestAnimationFrame(s):setTimeout(s,16)}(window);